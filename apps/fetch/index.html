<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge" />
<meta name="viewport" content="width-device-width"/>
<title>Fetch API</title>

<!-- Icons -->

<!-- Styles -->
<!-- Styles/Fonts -->

<!-- Styles/CSS -->

<!-- Scripts -->

</head>

<body>
<h1>Fetch API</h1>
<br />
<button id="getPosts">Get API Data Posts</button>
<button id="getPosts">Get Posts</button>
<hr />
<form id="addPost">
	<div>
		<input type="text" id="title" placeholder="Title">
	</div>
	<div>
		<textarea id="body" placeholder="Body"></textarea>
	</div>
	<input type="submit" value="Submit">
</form>

<hr />

<form id="getData">
	<div>
		<input type="text" id="inputURL" placeholder="Input URL">
	</div>
	<div>
		<input type="checkbox" id="selParseEngine">
	</div>
	<input type="submit" value="Submit">
</form>

<div id="output"></div>


<script>
// Event Listeners
document.getElementById('getPosts').addEventListener('click', getPosts);
document.getElementById('addPost').addEventListener('submit', addPost);
document.getElementById('getData').addEventListener('submit', getData);

// Variables
var encodedInputURL = encodeURIComponent(INPUT);
var apiEndpoint = "https://jsonplaceholder.typicode.com/posts";
var iframelyApiEndpointURL = "iframe.ly/api/iframely?url=" + encodedInputURL + "&api_key=57924d18254bf0be219387";

// Function: Get Posts
function getPosts(){
	fetch(apiEndpoint)
	.then((res) => res.json())
	.then((data) => {
		let output = '<h2>Posts</h2>';
		data.forEach(function(post) {
			output += `
				<div>
					<h3>${post.title}</h3>
					<p>${post.body}</p>
				</div>
			`;
		});
		document.getElementById('output').innerHTML = output;
	})
}

// Function: Add Post
function addPost(e) {
	e.preventDefault();
	
	let title = document.getElementById('title').value;
	let body = document.getElementById('body').value;

	fetch(apiEndpoint, {
		method:'POST',
		headers: {
		'Accept':'application/json, text/plain, */*',
		'Content-type':'application/json'
		},
		body:JSON.stringify({title:title, body:body})
	})
	.then((res) => res.json())
	.then((data) => console.log(data))
}

// Function Get Data (Parse URL)
function getData(){
	fetch(iframelyApiEndpointURL)
	.then((res) => res.json())
	.then((data) => {
		let output = '<h2>Get Data Output</h2>';
		data.forEach(function(post) {
			output += `
				<div>
					<h3>${post.title}</h3>
					<p>${post.body}</p>
				</div>
			`;
		});
		document.getElementById('output').innerHTML = output;
	})
}

</script>


</body>
</html>